<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ruleta de Medicamentos Hospitalarios ğŸ¥ğŸ’•</title>
  <style>
    :root {
      --primary: #3b82f6;
      --success: #10b981;
      --danger: #ef4444;
      --light: #f3f4f6;
      --dark: #1e293b;
    }
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);
      margin: 0;
      padding: 20px 10px;
      min-height: 100vh;
      color: var(--dark);
      text-align: center;
    }
    h1 {
      color: #1d4ed8;
      margin: 10px 0 4px;
      font-size: clamp(1.8rem, 6vw, 2.5rem);
    }
    .subtitle { color: #4b5563; margin: 0 0 20px; font-size: 1.1rem; }
    .ruleta-container {
      position: relative;
      width: min(340px, 85vw);
      height: min(340px, 85vw);
      margin: 25px auto;
    }
    .ruleta {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 10px solid var(--dark);
      box-shadow: 0 10px 40px rgba(0,0,0,0.25);
      position: relative;
      overflow: hidden;
      transition: transform 4.8s cubic-bezier(0.22, 0.61, 0.36, 1);
    }
    .sector {
      position: absolute;
      width: 50%;
      height: 50%;
      transform-origin: 100% 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      clip-path: polygon(0 0, 100% 0, 100% 100%);
    }
    .sector span {
      position: absolute;
      font-size: clamp(12px, 3.5vw, 15px);
      font-weight: 700;
      color: #111827;
      text-shadow: 0 1px 3px rgba(255,255,255,0.8);
      transform: translate(-50%, -50%) rotate(90deg);
      white-space: nowrap;
      width: 140px;
      text-align: center;
    }
    .flecha {
      width: 0; height: 0;
      border-left: 22px solid transparent;
      border-right: 22px solid transparent;
      border-bottom: 48px solid #dc2626;
      position: absolute;
      top: -38px;
      left: 50%;
      transform: translateX(-50%);
      filter: drop-shadow(0 4px 8px #0004);
      z-index: 5;
    }
    .controls { margin: 20px 0; }
    button {
      padding: 12px 28px;
      font-size: 1.05rem;
      font-weight: 600;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.22s;
      margin: 8px 4px;
    }
    .btn-primary   { background: var(--primary); color: white; }
    .btn-primary:hover { background: #2563eb; transform: translateY(-2px); }
    .btn-success   { background: var(--success); color: white; }
    .btn-danger    { background: var(--danger); color: white; }
    .pregunta-container {
      margin: 20px auto;
      max-width: 720px;
      background: white;
      border-radius: 16px;
      padding: 24px 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.12);
      display: none;
    }
    .progreso { font-weight: bold; color: #4b5563; margin-bottom: 12px; }
    .opcion {
      background: var(--light);
      padding: 16px 20px;
      margin: 10px auto;
      max-width: 540px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.18s;
      font-size: 1.05rem;
      border: 1px solid #d1d5db;
    }
    .opcion:hover { background: #e5e7eb; transform: translateY(-1px); }
    .correcta { background: #d1fae5 !important; border-color: #10b981; font-weight: 600; }
    .incorrecta { background: #fee2e2 !important; border-color: #ef4444; }
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 100;
    }
    .modal-content {
      background: white;
      padding: 28px 24px;
      border-radius: 16px;
      max-width: 90%;
      width: 420px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.3);
      text-align: center;
    }
    .modal-content h2 { margin: 0 0 16px; color: var(--dark); }
    .corazones { font-size: 1.8rem; margin: 12px 0; }
  </style>
</head>
<body>

<h1>Ruleta de Medicamentos Hospitalarios ğŸ¥</h1>
<p class="subtitle">Familia farmacolÃ³gica y funciÃ³n principal â€“ Â¡Para mi amor! ğŸ’•</p>

<div class="ruleta-container">
  <div class="flecha"></div>
  <div class="ruleta" id="ruleta"></div>
</div>

<div class="controls">
  <button id="btnGirar" class="btn-primary">Girar ruleta ğŸ¡</button>
</div>

<div class="pregunta-container" id="zonaPregunta">
  <div class="progreso" id="progreso"></div>
  <h2 id="textoPregunta"></h2>
  <div id="opciones"></div>
  <div style="margin-top: 24px;">
    <button id="btnSiguiente" class="btn-primary" style="display:none;">Siguiente â†’</button>
  </div>
</div>

<div class="modal" id="modalFinTema">
  <div class="modal-content">
    <h2 id="tituloFin"></h2>
    <p id="textoFin"></p>
    <div class="corazones" id="corazones"></div>
    <button class="btn-primary" onclick="cerrarModalYContinuar()">Girar de nuevo</button>
  </div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Datos â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const temas = [
  "AnalgÃ©sicos", "AntibiÃ³ticos", "Cardiovasculares",
  "Endocrinos", "Gastrointestinales", "Respiratorios"
];

const bancoPreguntas = { /* Tus preguntas originales â€“ puedes agregar mÃ¡s */
  "AnalgÃ©sicos": [
    { pregunta: "Â¿A quÃ© familia pertenece el paracetamol?", opciones: ["AnalgÃ©sico-antipirÃ©tico", "AntibiÃ³tico", "Corticoide"], correcta: 0 },
    { pregunta: "FunciÃ³n principal de la morfina:", opciones: ["AnalgÃ©sico opioide potente", "Antiinflamatorio", "AntipirÃ©tico"], correcta: 0 },
    { pregunta: "El tramadol es:", opciones: ["AnalgÃ©sico opioide", "Anticoagulante", "DiurÃ©tico"], correcta: 0 },
    { pregunta: "El metamizol sÃ³dico se usa principalmente como:", opciones: ["AnalgÃ©sico y antipirÃ©tico", "Antiinflamatorio esteroideo", "Opioide fuerte"], correcta: 0 }
  ],
  "AntibiÃ³ticos": [
    { pregunta: "La ceftriaxona pertenece a:", opciones: ["Cefalosporinas 3Âª gen", "MacrÃ³lidos", "AminoglucÃ³sidos"], correcta: 0 },
    { pregunta: "El metronidazol es eficaz contra:", opciones: ["Bacterias anaerobias y protozoarios", "Virus", "Hongos"], correcta: 0 },
    { pregunta: "La amoxicilina es un:", opciones: ["BetalactÃ¡mico (penicilina)", "Quinolona", "AntifÃºngico"], correcta: 0 }
  ],
  "Cardiovasculares": [
    { pregunta: "La furosemida es un:", opciones: ["DiurÃ©tico de asa", "IECA", "Betabloqueador"], correcta: 0 },
    { pregunta: "La adrenalina se usa principalmente para:", opciones: ["Emergencias y paro cardiorrespiratorio", "HipertensiÃ³n crÃ³nica", "Dolor leve"], correcta: 0 },
    { pregunta: "La noradrenalina actÃºa como:", opciones: ["Vasopresor potente", "AnalgÃ©sico", "Sedante"], correcta: 0 }
  ],
  "Endocrinos": [
    { pregunta: "La insulina NPH es:", opciones: ["AcciÃ³n intermedia", "AcciÃ³n rÃ¡pida", "AcciÃ³n ultralenta"], correcta: 0 },
    { pregunta: "La metformina se usa en:", opciones: ["Diabetes tipo 2", "Hipotiroidismo", "HipertensiÃ³n"], correcta: 0 },
    { pregunta: "La levotiroxina reemplaza:", opciones: ["Hormona tiroidea (T4)", "Insulina", "Cortisol"], correcta: 0 }
  ],
  "Gastrointestinales": [
    { pregunta: "El omeprazol es un:", opciones: ["Inhibidor de bomba de protones", "AntiemÃ©tico", "Laxante"], correcta: 0 },
    { pregunta: "La metoclopramida se usa como:", opciones: ["AntiemÃ©tico procinÃ©tico", "AnalgÃ©sico", "AntibiÃ³tico"], correcta: 0 },
    { pregunta: "La buscapina es:", opciones: ["AntiespasmÃ³dico", "Antiinflamatorio", "Anticoagulante"], correcta: 0 }
  ],
  "Respiratorios": [
    { pregunta: "El salbutamol es un:", opciones: ["Broncodilatador Î²2 agonista", "AntibiÃ³tico", "Corticoide"], correcta: 0 },
    { pregunta: "El atrovent actÃºa como:", opciones: ["Broncodilatador anticolinÃ©rgico", "AntihistamÃ­nico", "AntitusÃ­geno"], correcta: 0 },
    { pregunta: "La dexametasona es:", opciones: ["Corticosteroide potente", "AnalgÃ©sico", "AntibiÃ³tico"], correcta: 0 }
  ]
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Estado â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ruleta = document.getElementById("ruleta");
const zonaPregunta = document.getElementById("zonaPregunta");
const textoPregunta = document.getElementById("textoPregunta");
const opcionesDiv = document.getElementById("opciones");
const btnSiguiente = document.getElementById("btnSiguiente");
const btnGirar = document.getElementById("btnGirar");
const progreso = document.getElementById("progreso");
const modal = document.getElementById("modalFinTema");
const tituloFin = document.getElementById("tituloFin");
const textoFin = document.getElementById("textoFin");
const corazonesDiv = document.getElementById("corazones");

let preguntasTema = [];
let indicePregunta = 0;
let temaActual = "";
let aciertos = 0;
let totalEnTema = 0;
const temasUsadosRecientes = []; // evita repetir tema consecutivo
const MAX_RECientes = 2; // cuÃ¡ntos temas atrÃ¡s recordar

const coloresSectores = ["#bfdbfe","#bbf7d0","#fed7aa","#fecdd3","#e9d5ff","#a7f3d0"];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Crear ruleta â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
temas.forEach((tema, i) => {
  const sector = document.createElement("div");
  sector.className = "sector";
  sector.style.transform = `rotate(${i * (360 / temas.length)}deg)`;
  sector.style.background = coloresSectores[i % coloresSectores.length];

  const span = document.createElement("span");
  span.textContent = tema;
  sector.appendChild(span);
  ruleta.appendChild(sector);
});

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Utilidades â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function shuffleArray(arr) {
  const copy = [...arr];
  for (let i = copy.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [copy[i], copy[j]] = [copy[j], copy[i]];
  }
  return copy;
}

function elegirTemaNoRepetido() {
  let candidatos = temas.filter(t => !temasUsadosRecientes.includes(t));
  if (candidatos.length === 0) {
    // Si todos se usaron â†’ reiniciar historial
    temasUsadosRecientes.length = 0;
    candidatos = [...temas];
  }
  const idx = Math.floor(Math.random() * candidatos.length);
  const elegido = candidatos[idx];
  temasUsadosRecientes.push(elegido);
  if (temasUsadosRecientes.length > MAX_RECientes) temasUsadosRecientes.shift();
  return elegido;
}

function mostrarModal(titulo, texto, corazones = "") {
  tituloFin.textContent = titulo;
  textoFin.textContent = texto;
  corazonesDiv.textContent = corazones;
  modal.style.display = "flex";
}

function cerrarModalYContinuar() {
  modal.style.display = "none";
  zonaPregunta.style.display = "none";
  aciertos = 0;
  btnGirar.disabled = false;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LÃ³gica principal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function girarRuleta() {
  btnGirar.disabled = true;
  zonaPregunta.style.display = "none";
  btnSiguiente.style.display = "none";

  const vueltas = 4 + Math.floor(Math.random() * 5); // 4â€“8 vueltas
  const anguloExtra = Math.random() * 360;
  const rotacionTotal = vueltas * 360 + anguloExtra;

  ruleta.style.transform = `rotate(${rotacionTotal}deg)`;

  setTimeout(() => {
    temaActual = elegirTemaNoRepetido();
    preguntasTema = shuffleArray(bancoPreguntas[temaActual]);
    indicePregunta = 0;
    aciertos = 0;
    totalEnTema = preguntasTema.length;
    mostrarPregunta();
  }, 4800);
}

function mostrarPregunta() {
  if (indicePregunta >= totalEnTema) {
    const porcentaje = Math.round((aciertos / totalEnTema) * 100);
    let mensaje = `Â¡Terminaste "${temaActual}"! ğŸ‰\n`;
    mensaje += `Aciertos: ${aciertos}/${totalEnTema} (${porcentaje}%)\n\n`;
    if (porcentaje >= 90) mensaje += "Â¡Eres una genia mi amor! Te amo muchÃ­simo ğŸ˜ğŸ’–";
    else if (porcentaje >= 70) mensaje += "Â¡Muy bien mi vida! Vas increÃ­ble ğŸ”¥";
    else mensaje += "Â¡Sigue practicando mi reina! Ya casi lo dominas â¤ï¸";

    let hearts = "â¤ï¸".repeat(Math.min(Math.ceil(porcentaje / 20), 5));
    mostrarModal("Â¡Excelente!", mensaje, hearts);
    return;
  }

  const p = preguntasTema[indicePregunta];
  textoPregunta.textContent = p.pregunta;
  progreso.textContent = `Pregunta ${indicePregunta + 1} de ${totalEnTema} â€“ Tema: ${temaActual}`;

  const opcionesBarajadas = shuffleArray(p.opciones);
  const indiceCorrecto = opcionesBarajadas.indexOf(p.opciones[p.correcta]);

  opcionesDiv.innerHTML = "";
  zonaPregunta.style.display = "block";
  btnSiguiente.style.display = "none";

  opcionesBarajadas.forEach((op, i) => {
    const div = document.createElement("div");
    div.className = "opcion";
    div.textContent = op;
    div.onclick = () => {
      opcionesDiv.querySelectorAll(".opcion").forEach(o => o.onclick = null);
      if (i === indiceCorrecto) {
        div.classList.add("correcta");
        aciertos++;
      } else {
        div.classList.add("incorrecta");
        opcionesDiv.children[indiceCorrecto].classList.add("correcta");
      }
      btnSiguiente.style.display = "inline-block";
    };
    opcionesDiv.appendChild(div);
  });
}

function siguientePregunta() {
  indicePregunta++;
  mostrarPregunta();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Eventos iniciales â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
btnGirar.onclick = girarRuleta;
btnSiguiente.onclick = siguientePregunta;
</script>
</body>
</html>
