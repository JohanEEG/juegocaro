<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ruleta de Medicamentos Hospitalarios</title>

<style>
:root{
  --primary:#2563eb;
  --success:#16a34a;
  --danger:#dc2626;
  --bg:#eef2ff;
  --card:#ffffff;
  --text:#1e293b;
}
*{box-sizing:border-box}
body{
  margin:0;
  padding:20px;
  font-family:system-ui,-apple-system,sans-serif;
  background:var(--bg);
  color:var(--text);
  text-align:center;
}
h1{color:#1d4ed8;margin:5px 0}
.subtitle{color:#475569;margin-bottom:20px}

.ruleta-container{
  position:relative;
  width:320px;
  height:320px;
  margin:0 auto 20px;
}
.ruleta{
  width:100%;
  height:100%;
  border-radius:50%;
  border:8px solid #1e293b;
  overflow:hidden;
  transition:transform 4.8s cubic-bezier(.22,.61,.36,1);
}
.sector{
  position:absolute;
  width:50%;
  height:50%;
  transform-origin:100% 100%;
  clip-path:polygon(0 0,100% 0,100% 100%);
  display:flex;
  align-items:center;
  justify-content:center;
}
.sector span{
  transform:translate(-50%,-50%) rotate(90deg);
  font-size:12px;
  font-weight:700;
  width:130px;
}
.flecha{
  position:absolute;
  top:-30px;
  left:50%;
  transform:translateX(-50%);
  width:0;height:0;
  border-left:18px solid transparent;
  border-right:18px solid transparent;
  border-bottom:40px solid var(--danger);
  z-index:5;
}

button{
  border:none;
  padding:12px 26px;
  border-radius:999px;
  font-size:1rem;
  font-weight:600;
  cursor:pointer;
  margin:5px;
}
.primary{background:var(--primary);color:white}
.primary:hover{background:#1d4ed8}

.mute{background:#e5e7eb}

.card{
  background:var(--card);
  max-width:720px;
  margin:20px auto;
  padding:22px;
  border-radius:16px;
  box-shadow:0 10px 25px rgba(0,0,0,.15);
  display:none;
}
.opcion{
  background:#f1f5f9;
  margin:10px auto;
  padding:14px;
  max-width:520px;
  border-radius:12px;
  cursor:pointer;
  border:1px solid #cbd5f5;
}
.opcion:hover{background:#e0e7ff}
.correcta{background:#dcfce7;border-color:var(--success);font-weight:700}
.incorrecta{background:#fee2e2;border-color:var(--danger)}

.progreso{font-weight:600;color:#475569;margin-bottom:10px}

.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
}
.modal-content{
  background:white;
  padding:30px;
  border-radius:18px;
  max-width:400px;
}
</style>
</head>

<body>

<h1>Ruleta de Medicamentos Hospitalarios</h1>
<p class="subtitle">Familia farmacolÃ³gica y funciÃ³n</p>

<div class="ruleta-container">
  <div class="flecha"></div>
  <div class="ruleta" id="ruleta"></div>
</div>

<button id="btnGirar" class="primary">Girar ruleta</button>
<button class="mute" onclick="toggleMute()">ðŸ”Š / ðŸ”‡</button>

<div class="card" id="zonaPregunta">
  <div class="progreso" id="progreso"></div>
  <h2 id="textoPregunta"></h2>
  <div id="opciones"></div>
  <button id="btnSiguiente" class="primary" style="display:none">Siguiente</button>
</div>

<div class="modal" id="modal">
  <div class="modal-content">
    <h2 id="tituloModal"></h2>
    <p id="textoModal"></p>
    <button class="primary" onclick="cerrarModal()">Continuar</button>
  </div>
</div>

<!-- Sonidos -->
<audio id="spinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-slot-machine-spin-1938.mp3"></audio>
<audio id="okSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
<audio id="failSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
<audio id="endSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>

<script>
// ðŸ”“ desbloqueo audio
let unlocked=false;
document.addEventListener("click",()=>{
  if(unlocked) return;
  [spinSound,okSound,failSound,endSound].forEach(a=>{
    a.volume=.6;
    a.play().then(()=>{a.pause();a.currentTime=0});
  });
  unlocked=true;
},{once:true});

// mute
let muted=false;
function toggleMute(){
  muted=!muted;
  [spinSound,okSound,failSound,endSound].forEach(a=>a.muted=muted);
}

// datos
const temas=[
"AnalgÃ©sicos","AntibiÃ³ticos","Cardiovasculares","DiurÃ©ticos",
"Endocrinos","Gastrointestinales","Respiratorios",
"Corticoides","Emergencias","Anticoagulantes"
];

const preguntas={
"AnalgÃ©sicos":[
{q:"Paracetamol es:",o:["AnalgÃ©sico-antipirÃ©tico","AINE","Opioide"],c:0},
{q:"Morfina:",o:["Opioide fuerte","AINE","AntibiÃ³tico"],c:0}
],
"AntibiÃ³ticos":[
{q:"Ceftriaxona:",o:["Cefalosporina 3Âª gen","Penicilina","Quinolona"],c:0},
{q:"Metronidazol cubre:",o:["Anaerobios","Virus","Hongos"],c:0}
],
"Cardiovasculares":[
{q:"Enalapril es:",o:["IECA","ARA-II","DiurÃ©tico"],c:0},
{q:"Amlodipino:",o:["BCC","IECA","Betabloqueador"],c:0}
],
"DiurÃ©ticos":[
{q:"Furosemida:",o:["DiurÃ©tico de asa","Tiazida","Ahorrador K"],c:0}
],
"Endocrinos":[
{q:"Insulina NPH:",o:["Intermedia","RÃ¡pida","Lenta"],c:0}
],
"Gastrointestinales":[
{q:"Omeprazol:",o:["IBP","AntiemÃ©tico","AINE"],c:0}
],
"Respiratorios":[
{q:"Salbutamol:",o:["Beta-2 agonista","Corticoide","AnticolinÃ©rgico"],c:0}
],
"Corticoides":[
{q:"Dexametasona:",o:["Corticoide potente","AINE","Opioide"],c:0}
],
"Emergencias":[
{q:"Adrenalina:",o:["Anafilaxia","HipertensiÃ³n","Dolor"],c:0}
],
"Anticoagulantes":[
{q:"Enoxaparina:",o:["HBPM","Antiagregante","FibrinolÃ­tico"],c:0}
]
};

// ruleta
const ruleta=document.getElementById("ruleta");
const colores=["#bfdbfe","#bbf7d0","#fed7aa","#fecaca","#ddd6fe"];
temas.forEach((t,i)=>{
  const s=document.createElement("div");
  s.className="sector";
  s.style.background=colores[i%colores.length];
  s.style.transform=`rotate(${i*(360/temas.length)}deg)`;
  const sp=document.createElement("span");
  sp.textContent=t;
  s.appendChild(sp);
  ruleta.appendChild(s);
});

// juego
let temaActual="",lista=[],i=0,ok=0;
const btnGirar=document.getElementById("btnGirar");
const zona=document.getElementById("zonaPregunta");
const texto=document.getElementById("textoPregunta");
const opcionesDiv=document.getElementById("opciones");
const prog=document.getElementById("progreso");
const btnSig=document.getElementById("btnSiguiente");

btnGirar.onclick=()=>{
  btnGirar.disabled=true;
  spinSound.currentTime=0; spinSound.play();
  const rot=1440+Math.random()*360;
  ruleta.style.transform=`rotate(${rot}deg)`;
  setTimeout(()=>{
    temaActual=temas[Math.floor(Math.random()*temas.length)];
    lista=[...preguntas[temaActual]];
    i=0; ok=0;
    mostrar();
  },4800);
};

function mostrar(){
  if(i>=lista.length){
    endSound.play();
    modal("Fin del tema",`Aciertos: ${ok}/${lista.length}`);
    return;
  }
  zona.style.display="block";
  const p=lista[i];
  texto.textContent=p.q;
  prog.textContent=`${temaActual} â€“ Pregunta ${i+1}/${lista.length}`;
  opcionesDiv.innerHTML="";
  btnSig.style.display="none";
  const ops=[...p.o].sort(()=>Math.random()-.5);
  const idx=ops.indexOf(p.o[p.c]);
  ops.forEach((op,j)=>{
    const d=document.createElement("div");
    d.className="opcion";
    d.textContent=op;
    d.onclick=()=>{
      document.querySelectorAll(".opcion").forEach(x=>x.onclick=null);
      if(j===idx){d.classList.add("correcta");ok++;okSound.play();}
      else{d.classList.add("incorrecta");failSound.play();}
      btnSig.style.display="inline-block";
    };
    opcionesDiv.appendChild(d);
  });
}

btnSig.onclick=()=>{i++;mostrar();};

function modal(t,m){
  document.getElementById("tituloModal").textContent=t;
  document.getElementById("textoModal").textContent=m;
  document.getElementById("modal").style.display="flex";
}
function cerrarModal(){
  document.getElementById("modal").style.display="none";
  zona.style.display="none";
  btnGirar.disabled=false;
}
</script>
</body>
</html>
